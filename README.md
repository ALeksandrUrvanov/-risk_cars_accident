# Oценить риск ДТП по выбранному маршруту движения


## Задача:

Нужно создать модель, которая могла бы оценить риск ДТП по выбранному маршруту движения. Под риском понимается вероятность ДТП с любым повреждением транспортного средства. Как только водитель забронировал автомобиль, сел за руль и выбрал маршрут, система должна оценить уровень риска. Если уровень риска высок, водитель увидит предупреждение и рекомендации по маршруту.

Идея создания такой системы находится в стадии предварительного обсуждения и проработки. Чёткого алгоритма работы и подобных решений на рынке ещё не существует. Текущая задача — понять, возможно ли предсказывать ДТП, опираясь на исторические данные одного из регионов.

Идея решения задачи от заказчика:

1. Создать модель предсказания ДТП (целевое значение — at_fault (виновник) в таблице parties) 
  - Для модели выбрать тип виновника — только машина (car).
  - Выбрать случаи, когда ДТП привело к любым повреждениям транспортного средства, кроме типа SCRATCH (царапина).
  - Для моделирования ограничиться данными за 2012 год — они самые свежие.
  - Обязательное условие — учесть фактор возраста автомобиля.
2. На основе модели исследовать основные факторы ДТП.   

3. Понять, помогут ли результаты моделирования и анализ важности факторов ответить на вопросы:
  - Возможно ли создать адекватную системы оценки водительского риска при выдаче авто?
  - Какие ещё факторы нужно учесть?
  - Нужно ли оборудовать автомобиль какими-либо датчиками или камерой?


## Используемые библиотеки
- pandas
- numpy
- scipy
- sklearn
- matplotlib
- seaborn
- phik
- lightgbm
- shap
- math

## Отработанные методы и навыки
1. Загрузка и подготовка данных.
2. Первичное исследование таблиц.
3. Cтатистический анализ факторов ДТП.

## Итоги проекта

Использовали модель LightGBM - это фреймворк, который предоставляет реализацию деревьев принятия решений с градиентным бустингом. Удалось обучить модель на тестовых данных и получить метрику recall равную 72.9%, precision - 74.3%, а f1 - 72.7%. <br>

True Positives - 33,5% <br>
True Negatives - 39.6% <br>
False Positives - 19.2% <br>
False Negatives - 7.3% <br>

К 19.2% клиентам будут применены излишние коэффициенты к цене(тарифу) проезда. А 7.3% клиентов будут упущены, как риск. Это небольшой процент, но можно его уменьшить! С представленными данными не получится получить предсказания с большой точностью, так как в основном мы имеем признаки последствия ДТП или косвеные признаки. Для улучшения качества предсказания виновника ДТП предлагаю собирать следующие данные: <br>

возраст водителя, который скоррелирован с манерой вождения; <br>
водительский стаж, который скоррелирован с опытом вождения в различных ситуациях; <br> 
виды правонарушений за клиентом за определенный период (превышение скорости, опасное вождение, лишение прав за вождение в состоянии алкогольного опьянения и так далее);

 


```python
